<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ESP32 Smart Control</title>
 
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family: Arial;
  background:#0f0f0f;
  color:#fff;
  text-align:center;
}
h2{margin-top:15px;}
button{
  padding:10px 20px;
  margin:10px;
  border:none;
  border-radius:6px;
  font-size:16px;
  cursor:pointer;
}
.on{background:#00c853;color:#fff;}
.off{background:#d50000;color:#fff;}

/* LED */
.led{
  width:18px;height:18px;border-radius:50%;
  background:#333;margin:10px auto;
}
.led-on{
  background:#00ff9c;
  box-shadow:0 0 10px #00ff9c;
  animation:blink 1s infinite alternate;
}
@keyframes blink{from{opacity:.4}to{opacity:1}}

/* FAN */
.fan-wrap{width:60px;height:60px;margin:10px auto;}
.fan{width:100%;height:100%;position:relative;}
.blade{
  width:28px;height:6px;background:#ccc;
  position:absolute;top:27px;left:30px;
  transform-origin:0% 50%;
}
.blade:nth-child(1){transform:rotate(0deg);}
.blade:nth-child(2){transform:rotate(120deg);}
.blade:nth-child(3){transform:rotate(240deg);}
.fan-on{animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}

/* PLUG */
.plug{
  width:24px;height:40px;margin:10px auto;
  background:#444;border-radius:4px;
}
.plug-on{
  background:#00e676;
  box-shadow:0 0 12px #00e676;
}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>

<body>

<h2>ESP32 Smart Device Control</h2>
   <script>
    // ðŸ”´ ONLY DATABASE URL (NO API KEY)
    const firebaseURL =
      "https://sample-home-automation-baee3-default-rtdb.firebaseio.com";

    function setLED(state) {
      fetch(firebaseURL, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(state)
      });
    }
  </script>

<!-- LED -->
<div>
  <h3>LED</h3>
  <div id="ledIcon" class="led"></div>
  <button class="on" onclick="setDevice('led','ON')">ON</button>
  <button class="off" onclick="setDevice('led','OFF')">OFF</button>
</div>

<!-- FAN -->
<div>
  <h3>FAN</h3>
  <div class="fan-wrap">
    <div id="fanIcon" class="fan">
      <div class="blade"></div>
      <div class="blade"></div>
      <div class="blade"></div>
    </div>
  </div>
  <button class="on" onclick="setDevice('fan','ON')">ON</button>
  <button class="off" onclick="setDevice('fan','OFF')">OFF</button>
</div>

<!-- PLUG -->
<div>
  <h3>PLUG</h3>
  <div id="plugIcon" class="plug"></div>
  <button class="on" onclick="setDevice('plug','ON')">ON</button>
  <button class="off" onclick="setDevice('plug','OFF')">OFF</button>
</div>

<script>
/* ðŸ”¹ Firebase Config (CHANGE VALUES) */
const firebaseConfig = {
  apiKey: "",
  authDomain: "espcontroller-bd521.firebaseapp.com",
  databaseURL: "https://espcontroller-bd521-default-rtdb.firebaseio.com",
  projectId: "espcontroller-bd521"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* Write to Firebase */
function setDevice(device, state){
  db.ref(device).set(state);
}

/* Read & Animate */
db.ref().on("value", snap=>{
  const d = snap.val();

  // LED
  document.getElementById("ledIcon").className =
    d.led === "ON" ? "led led-on" : "led";

  // FAN
  document.getElementById("fanIcon").className =
    d.fan === "ON" ? "fan fan-on" : "fan";

  // PLUG
  document.getElementById("plugIcon").className =
    d.plug === "ON" ? "plug plug-on" : "plug";
});
</script>

</body>
</html>
